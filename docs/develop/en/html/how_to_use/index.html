
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3. Basic Usage &#8212; abICS 2.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Tutorial" href="../tutorial/index.html" />
    <link rel="prev" title="2.1. Prerequisites" href="../install/install.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="basic-usage">
<span id="sec-basic-usage"></span><h1><span class="section-number">3. </span>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this heading">¶</a></h1>
<p>In abICS, all solver and sampler parameters other than the position coordinates must be prepared in advance.
To this end, abICS requires two input files: (1) a reference file for specifiying solver parameters that is formatted according to the solver input format,
and (2) an input file for specifying parameters that control how abICS performs the configurational sampling.</p>
<section id="preparing-a-reference-file-for-active-learning">
<span id="subsec-basic-reference"></span><h2><span class="section-number">3.1. </span>Preparing a reference file for active learning<a class="headerlink" href="#preparing-a-reference-file-for-active-learning" title="Permalink to this heading">¶</a></h2>
<p>The user must prepare a reference file for active learning according to the input format of the solver to be used.
The path of the reference file is specified by <code class="docutils literal notranslate"><span class="pre">base_input_dir</span></code> in the <code class="docutils literal notranslate"><span class="pre">[mlref.solver]</span></code> section in the abICS input file (see below).
The coordinate information should not be written here because it will obviously change in the course of the simulation.
The following is an example of a QE reference file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;CONTROL
  calculation = &#39;relax&#39;
  tstress = .false.
  tprnfor = .false.
  pseudo_dir = &#39;~/qe/pot&#39;
  disk_io = &#39;low&#39;
  wf_collect = .false.
/
&amp;SYSTEM
  ecutwfc      =  60.0
  occupations  = &quot;smearing&quot;
  smearing     = &quot;gauss&quot;
  degauss      = 0.01
/
&amp;electrons
  mixing_beta = 0.7
  conv_thr = 1.0d-8
  electron_maxstep = 100
/
&amp;ions
/
ATOMIC_SPECIES
Al 26.981 Al.pbe-nl-kjpaw_psl.1.0.0.UPF
Mg 24.305 Mg.pbe-spnl-kjpaw_psl.1.0.0.UPF
O  16.000 O.pbe-n-kjpaw_psl.1.0.0.UPF
ATOMIC_POSITIONS crystal

K_POINTS gamma
</pre></div>
</div>
<section id="specific-notes-of-solvers-for-active-learning">
<span id="solver-specific-notes"></span><h3><span class="section-number">3.1.1. </span>Specific notes of solvers for active learning<a class="headerlink" href="#specific-notes-of-solvers-for-active-learning" title="Permalink to this heading">¶</a></h3>
<p>In abICS, the coordinates of atoms are updated. Other settings are basically specified on the reference file for each solver.
However, the specification of atoms to be relaxed can be controlled by abICS.
To enable the structural optimization option, please set the option to do structural optimization in the reference file of the solver, and also specify the related parameters such as the total number of steps for relaxation.
Furthermore, in abICS, a reference file name, a rule of a reference file, and an executable format <code class="docutils literal notranslate"><span class="pre">run_scheme</span></code> in the input file of abICS must be set on a solver-by-solver basis. We’ll explain them below.</p>
<section id="vasp">
<h4>VASP<a class="headerlink" href="#vasp" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>URL : <a class="reference external" href="https://www.vasp.at">https://www.vasp.at</a></p></li>
<li><p>Rules of a reference file</p>
<ul>
<li><p>Please prepare INCAR, POTCAR, KPOINTS files.</p>
<ul>
<li><p>In POTCAR file, please arrange the atoms in alphabetical order.</p></li>
<li><p>The POSCAR file is basically not needed, but maybe needed depending on the version of <code class="docutils literal notranslate"><span class="pre">pymatgen</span></code>.
In that case, please prepare a suitable file.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="quantum-espresso">
<h4>Quantum Espresso<a class="headerlink" href="#quantum-espresso" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>URL : <a class="reference external" href="https://www.quantum-espresso.org">https://www.quantum-espresso.org</a></p></li>
<li><p>Available version: 6.2 or higher</p>
<ul>
<li><p>“Old XML” format is not available</p></li>
</ul>
</li>
<li><p>Rules of a reference file</p>
<ul>
<li><p>Please set a reference file name as <code class="docutils literal notranslate"><span class="pre">scf.in</span></code> .</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calculation</span></code> option must be <code class="docutils literal notranslate"><span class="pre">scf</span></code> or <code class="docutils literal notranslate"><span class="pre">relax</span></code> .</p></li>
<li><p>If the calculation is done only at <span class="math notranslate nohighlight">\(\Gamma\)</span> point, the calculation becomes fast if you set <code class="docutils literal notranslate"><span class="pre">Gamma</span></code> in <code class="docutils literal notranslate"><span class="pre">kpoints</span></code>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="openmx">
<h4>OpenMX<a class="headerlink" href="#openmx" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>URL : <a class="reference external" href="http://www.openmx-square.org">http://www.openmx-square.org</a></p></li>
<li><p>Available version: 3.9</p></li>
<li><p>A rule of reference file</p>
<ul>
<li><p>Please set a reference file name as <code class="docutils literal notranslate"><span class="pre">base.dat</span></code> .</p></li>
</ul>
</li>
</ul>
</section>
</section>
</section>
<section id="preparing-a-reference-file">
<h2><span class="section-number">3.2. </span>Preparing a reference file<a class="headerlink" href="#preparing-a-reference-file" title="Permalink to this heading">¶</a></h2>
<p>The user must prepare a reference file according to the input format of the solver to be used.
The path of the reference file is specified by <code class="docutils literal notranslate"><span class="pre">base_input_dir</span></code> in the <code class="docutils literal notranslate"><span class="pre">[solver]</span></code> section in the abICS input file (see below).
The coordinate information should not be written here because it will obviously change in the course of the simulation.
The lattice sites are specified in a separate abICS input file (see below),
and abICS will take care of generating the coordinates section at each sampling step.
The following is an example of an aenet reference file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TYPES
2
Mg
Al


NETWORKS
Mg    Mg.15t-15t.nn
Al  Al.15t-15t.nn


VERBOSITY low

#FILES
#1
#structure.xsf
</pre></div>
</div>
<section id="id1">
<span id="id2"></span><h3><span class="section-number">3.2.1. </span>Solver specific notes<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<section id="aenet">
<h4>aenet<a class="headerlink" href="#aenet" title="Permalink to this heading">¶</a></h4>
<ul>
<li><p>URL : <a class="reference external" href="http://ann.atomistic.net">http://ann.atomistic.net</a></p></li>
<li><p>Checked with version 2.0.3 (2018-06-25).</p></li>
<li><p>A rule of referene file</p>
<ul class="simple">
<li><p>Place the input files for aenet in the <code class="docutils literal notranslate"><span class="pre">generate</span></code>, <code class="docutils literal notranslate"><span class="pre">train</span></code>, and <code class="docutils literal notranslate"><span class="pre">predict</span></code> directories in the directory which is set in the <code class="docutils literal notranslate"><span class="pre">base_input_dir</span></code> of the <code class="docutils literal notranslate"><span class="pre">[trainer]</span></code> section.</p></li>
<li><p>aenet compiles the atomic configuration and energy data for training into an intermediate binary format that is converted to atomic environment descriptor-energy relationships before training. Please place the input files for this conversion <code class="docutils literal notranslate"><span class="pre">generate.x</span></code> in the <code class="docutils literal notranslate"><span class="pre">generate</span></code> directory.</p></li>
<li><p>Place an input file for <code class="docutils literal notranslate"><span class="pre">train.x</span></code> in the <code class="docutils literal notranslate"><span class="pre">train</span></code> directory that reads the training data generated by <code class="docutils literal notranslate"><span class="pre">generate.x</span></code> and trains. The file should be named <code class="docutils literal notranslate"><span class="pre">train.in</span></code>.</p></li>
<li><p>Place the input file <code class="docutils literal notranslate"><span class="pre">predict.in</span></code> for <code class="docutils literal notranslate"><span class="pre">predict.x</span></code> in the <code class="docutils literal notranslate"><span class="pre">predict</span></code> directory to evaluate the energy for the input coordinates using the trained potential model.</p></li>
</ul>
</li>
<li><p>A rule of an input file of abICS</p>
<ul class="simple">
<li><p>In the <code class="docutils literal notranslate"><span class="pre">[solver]</span></code> section, for <code class="docutils literal notranslate"><span class="pre">type</span></code> , <code class="docutils literal notranslate"><span class="pre">perturb</span></code> , and <code class="docutils literal notranslate"><span class="pre">run_scheme</span></code>, set the following if using an active learning scheme.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span> <span class="o">=</span> “aenet”
<span class="nv">perturb</span> <span class="o">=</span> <span class="m">0</span>.0
<span class="nv">run_scheme</span> <span class="o">=</span> ‘subprocess’
</pre></div>
</div>
</li>
</ul>
</section>
</section>
</section>
<section id="preparing-an-input-file-of-abics">
<span id="subsec-basic-input"></span><h2><span class="section-number">3.3. </span>Preparing an input file of abICS<a class="headerlink" href="#preparing-an-input-file-of-abics" title="Permalink to this heading">¶</a></h2>
<p>The input file of abICS is constructed by the following five sections:</p>
<ol class="arabic simple">
<li><p>[sampling] section specifies the parameters of the replica exchange Monte Carlo part, such as the number of replicas, the temperature range, and the number of Monte Carlo steps. In addition, [sampling.solver] subsection specifies the parameters for the (first principle calculation) solver, including the type of solver (VASP, QE,…), the path to the solver, and the directory containing immutable input files.</p></li>
<li><p>[mlref] section specifies options for extracting only atomic configurations from the sampling results in order to evaluate the accuracy of the neural network model and to expand the training data. In addition, for generating training data, [mlref.solver] subsection specifies the parameters for the (first principle calculation) solver, including the type of solver (VASP, QE,…), the path to the solver, and the directory containing immutable input files. This section is used for <code class="docutils literal notranslate"><span class="pre">abics_mlref</span></code> .</p></li>
<li><p>[train] section specifies optinons for making a trainer to learn a placement energy prediction model from training data.  This section is used for <code class="docutils literal notranslate"><span class="pre">abics_train</span></code> .</p></li>
<li><p>[observer] section specifies the type of physical quantity to be calculated.</p></li>
<li><p>[config] section specifies the configuration of the alloy, etc.</p></li>
</ol>
<p>For details, see <a class="reference internal" href="../inputfiles/index.html"><span class="doc">Input Files Format</span></a> .
The following is an example of an input file selecting aenet as a solver.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[sampling]
nreplicas = 7
nprocs_per_replica = 1 

kTstart = 600.0
kTend = 1400.0

nsteps = 1600  # Number of steps for sampling
RXtrial_frequency = 4
sample_frequency = 16
print_frequency = 1
reload = false

[sampling.solver]
type = &#39;aenet&#39;
path= &#39;~/git/aenet/bin/predict.x-2.0.4-gfortran_serial&#39;
base_input_dir = &#39;./baseinput&#39;
perturb = 0.0
run_scheme = &#39;subprocess&#39; #&#39;mpi_spawn_ready&#39;
ignore_species = [&quot;O&quot;]

[config]
unitcell = [[8.1135997772, 0.0000000000, 0.0000000000],
            [0.0000000000, 8.1135997772, 0.0000000000],
            [0.0000000000, 0.0000000000, 8.1135997772]]
supercell = [1,1,1]

[[config.base_structure]]
type = &quot;O&quot;
coords = [
     [0.237399980, 0.237399980, 0.237399980],
     [0.762599945, 0.762599945, 0.762599945],
     [0.512599945, 0.012600004, 0.737399936],
     [0.487399966, 0.987399936, 0.262599975],
     [0.012600004, 0.737399936, 0.512599945],
     [0.987399936, 0.262599975, 0.487399966],
     [0.737399936, 0.512599945, 0.012600004],
     [0.262599975, 0.487399966, 0.987399936],
     [0.987399936, 0.487399966, 0.262599975],
     [0.012600004, 0.512599945, 0.737399936],
     [0.487399966, 0.262599975, 0.987399936],
     [0.512599945, 0.737399936, 0.012600004],
     [0.262599975, 0.987399936, 0.487399966],
     [0.737399936, 0.012600004, 0.512599945],
     [0.237399980, 0.737399936, 0.737399936],
     [0.762599945, 0.262599975, 0.262599975],
     [0.512599945, 0.512599945, 0.237399980],
     [0.487399966, 0.487399966, 0.762599945],
     [0.012600004, 0.237399980, 0.012600004],
     [0.987399936, 0.762599945, 0.987399936],
     [0.987399936, 0.987399936, 0.762599945],
     [0.012600004, 0.012600004, 0.237399980],
     [0.487399966, 0.762599945, 0.487399966],
     [0.512599945, 0.237399980, 0.512599945],
     [0.737399936, 0.237399980, 0.737399936],
     [0.262599975, 0.762599945, 0.262599975],
     [0.237399980, 0.512599945, 0.512599945],
     [0.762599945, 0.487399966, 0.487399966],
     [0.762599945, 0.987399936, 0.987399936],
     [0.237399980, 0.012600004, 0.012600004],
     [0.737399936, 0.737399936, 0.237399980],
     [0.262599975, 0.262599975, 0.762599945],
     ]

[[config.defect_structure]]
coords = [
     [0.000000000, 0.000000000, 0.000000000],
     [0.749999940, 0.249999985, 0.499999970],
     [0.249999985, 0.749999940, 0.499999970],
     [0.249999985, 0.499999970, 0.749999940],
     [0.749999940, 0.499999970, 0.249999985],
     [0.499999970, 0.749999940, 0.249999985],
     [0.499999970, 0.249999985, 0.749999940],
     [0.000000000, 0.499999970, 0.499999970],
     [0.749999940, 0.749999940, 0.000000000],
     [0.249999985, 0.249999985, 0.000000000],
     [0.249999985, 0.000000000, 0.249999985],
     [0.749999940, 0.000000000, 0.749999940],
     [0.499999970, 0.000000000, 0.499999970],
     [0.000000000, 0.749999940, 0.749999940],
     [0.000000000, 0.249999985, 0.249999985],
     [0.499999970, 0.499999970, 0.000000000],
     [0.374999970, 0.374999970, 0.374999970],
     [0.624999940, 0.624999940, 0.624999940],
     [0.374999970, 0.874999940, 0.874999940],
     [0.624999940, 0.124999993, 0.124999993],
     [0.874999940, 0.874999940, 0.374999970],
     [0.124999993, 0.124999993, 0.624999940],
     [0.874999940, 0.374999970, 0.874999940],
     [0.124999993, 0.624999940, 0.124999993],
     ]
[[config.defect_structure.groups]]
name = &#39;Al&#39;
# species = [&#39;Al&#39;]    # default
# coords = [[[0,0,0]]]  # default
num = 16 #432 #16000
[[config.defect_structure.groups]]
name = &#39;Mg&#39;
# species = [&#39;Mg&#39;]    # default
# coords = [[[0,0,0]]]  # default
num = 8 #216 #8000


[observer]
ignored_species = [&#39;O&#39;]
</pre></div>
</div>
</section>
<section id="creating-a-set-of-training-data">
<h2><span class="section-number">3.4. </span>Creating a set of training data<a class="headerlink" href="#creating-a-set-of-training-data" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Generate a set of input files for the first-principle calculation using <code class="docutils literal notranslate"><span class="pre">abics_mlref</span></code>.</p></li>
<li><p>Perform the first-principle calculation with these inputs. (In the tutorial GNU parallel is used for the exhaustive calculation.)</p></li>
</ol>
</section>
<section id="creating-a-neural-network">
<h2><span class="section-number">3.5. </span>Creating a neural network<a class="headerlink" href="#creating-a-neural-network" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">abics_mlref</span></code> again to convert the results of the first-principle calculation into a common format that <code class="docutils literal notranslate"><span class="pre">abics_train</span></code> will read.</p></li>
<li><p>Execute <code class="docutils literal notranslate"><span class="pre">abics_train</span></code> to create a neural network. When the calculation is completed successfully, the trained neural network is output in <code class="docutils literal notranslate"><span class="pre">baseinput</span></code> directory.</p></li>
</ol>
</section>
<section id="predicting-the-optimized-structure">
<h2><span class="section-number">3.6. </span>Predicting the optimized structure<a class="headerlink" href="#predicting-the-optimized-structure" title="Permalink to this heading">¶</a></h2>
<p>By using <code class="docutils literal notranslate"><span class="pre">abics_sampling</span></code> the optimized structure is found from the trained neural network.
(The number of MPI processes must be larger than the number of replicas.)
Running the program will create directories named by the replica numbers under the current directory,
and each replica runs the solver in it.</p>
<a class="reference internal image-reference" href="../_images/schmatic_AR.png"><img alt="../_images/schmatic_AR.png" class="align-center" src="../_images/schmatic_AR.png" style="width: 800px;" /></a>
<p>A schematic view of the active learning in abICS.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">abICS</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">1. About abICS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">2. Install</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. Basic Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#preparing-a-reference-file-for-active-learning">3.1. Preparing a reference file for active learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparing-a-reference-file">3.2. Preparing a reference file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparing-an-input-file-of-abics">3.3. Preparing an input file of abICS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-set-of-training-data">3.4. Creating a set of training data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-neural-network">3.5. Creating a neural network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#predicting-the-optimized-structure">3.6. Predicting the optimized structure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">4. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inputfiles/index.html">5. Input Files Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outputfiles/index.html">6. Output Files Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">7. Miscellaneous tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithm/index.html">8. Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledge/index.html">9. Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact/index.html">10. Contacts</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../install/install.html" title="previous chapter"><span class="section-number">2.1. </span>Prerequisites</a></li>
      <li>Next: <a href="../tutorial/index.html" title="next chapter"><span class="section-number">4. </span>Tutorial</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019-, Institute for Solid State Physics, University of Tokyo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/how_to_use/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>